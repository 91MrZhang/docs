(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{486:function(t,v,_){"use strict";_.r(v);var r=_(27),a=Object(r.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h3",{attrs:{id:"锁的四种状态"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#锁的四种状态"}},[t._v("#")]),t._v(" 锁的四种状态")]),t._v(" "),_("ol",[_("li",[t._v("无所态")]),t._v(" "),_("li",[t._v("偏向锁")]),t._v(" "),_("li",[t._v("轻量级锁（自旋形式)")]),t._v(" "),_("li",[t._v("重量级锁")])]),t._v(" "),_("h3",{attrs:{id:"锁状态升级（膨胀）"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#锁状态升级（膨胀）"}},[t._v("#")]),t._v(" 锁状态升级（膨胀）")]),t._v(" "),_("p",[t._v("https://www.zhihu.com/search?type=content&q=%E9%94%81%E7%8A%B6%E6%80%81%E5%8D%87%E7%BA%A7")]),t._v(" "),_("p",[t._v("也不重复板砖了，简单描述一下")]),t._v(" "),_("p",[_("strong",[t._v("1-5偏向锁过程、6-9轻量级锁过程、10重量级锁")])]),t._v(" "),_("ol",[_("li",[t._v("线程A刚开始执行时，在markword处贴上自己的线程ID")]),t._v(" "),_("li",[t._v("线程A执行完成后，撤退")]),t._v(" "),_("li",[t._v("线程B过来执行，发现mardword处贴着线程A的ID")]),t._v(" "),_("li",[t._v("JVM协助判断一下，发现线程A已经执行完了，所以把markword处线程A的ID撕掉，贴上线程B的ID")]),t._v(" "),_("li",[t._v("线程B开始执行")])]),t._v(" "),_("hr"),t._v(" "),_("ol",{attrs:{start:"6"}},[_("li",[t._v("线程C也过来执行，但是markword上贴着B的线程ID")]),t._v(" "),_("li",[t._v("JVM协助判断，发现B还在工作")]),t._v(" "),_("li",[t._v("这个时候C开始自旋，CAS方式，视图将markword更改为自己栈帧中的指针")]),t._v(" "),_("li",[t._v("B完成之后，B和C要同时自旋，抢着修改markword")])]),t._v(" "),_("hr"),t._v(" "),_("ol",{attrs:{start:"10"}},[_("li",[t._v("JVM会自动判断，如果自旋次数过多，则自动转变为重量级锁")])]),t._v(" "),_("p",[_("strong",[t._v("膨胀后不可降级")]),t._v("，但有的文章也提到GC阶段会降级")])])}),[],!1,null,null,null);v.default=a.exports}}]);