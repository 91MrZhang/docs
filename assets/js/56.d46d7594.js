(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{458:function(a,s,t){"use strict";t.r(s);var r=t(27),e=Object(r.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("这里介绍一下实际工作中常用的JVM、GC参数")])]),a._v(" "),t("h3",{attrs:{id:"jvm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jvm"}},[a._v("#")]),a._v(" JVM")]),a._v(" "),t("h4",{attrs:{id:"堆设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#堆设置"}},[a._v("#")]),a._v(" 堆设置")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Xms8196m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Xmx8196m")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Xss400k")]),a._v("\n")])])]),t("p",[a._v("目前业界基本都设成一样的，好处如下：")]),a._v(" "),t("ol",[t("li",[a._v("初次启动时，垃圾回收器会因为你的最小值多进行很多次GC")]),a._v(" "),t("li",[a._v("GC完成了，JVM释放堆内存给OS，不够了还需要向OS申请，麻烦")]),a._v(" "),t("li",[a._v("如果你的操作系统用了硬盘当虚拟内存，真实内存不够的话，向硬盘申请效率奇低（JVM把用真实内存的机会让给了其他应用）")])]),a._v(" "),t("p",[a._v("方法区不用额外设置，因为1.8使用直接内存了")]),a._v(" "),t("p",[a._v("原则上尽最大限度保证堆空间大小，并且不要随意改分代大小和分代比例（JDK厂商经过大量实践给出的结论，一定是有道理的，自己乱调容易东边不亮西边亮）")]),a._v(" "),t("h4",{attrs:{id:"oom时，生成堆快照"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oom时，生成堆快照"}},[a._v("#")]),a._v(" OOM时，生成堆快照")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HeapDumpOnOutOfMemoryError")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HeapDumpPath")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("\\usr\\xxx\\logs\\\n")])])]),t("p",[a._v("这个会在OOM时，生成一个xxx.hprof的堆快照文件，用JProfiler后者Eclipse的MAT都可以打开，在实际工作中很有用，分析结果定位问题")]),a._v(" "),t("h3",{attrs:{id:"gc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gc"}},[a._v("#")]),a._v(" GC")]),a._v(" "),t("h4",{attrs:{id:"各种gc回收器的指定方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#各种gc回收器的指定方式"}},[a._v("#")]),a._v(" 各种GC回收器的指定方式")]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("-XX:+UseSerialGC")]),a._v(" "),t("th",[a._v("新生代和老年代都使用串行收集器")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("-XX:+UseParNewGC")]),a._v(" "),t("td",[a._v("新生代使用ParNew垃圾回收器，老年代使用串行收集器")])]),a._v(" "),t("tr",[t("td",[a._v("-XX:+UseParallelGC")]),a._v(" "),t("td",[a._v("新生代使用PararllelGC回收器，老年代使用串行收集器")])]),a._v(" "),t("tr",[t("td",[a._v("-XX:+UseParallelOldGC")]),a._v(" "),t("td",[a._v("新生代使用ParallelGC,老年代使用ParallelOldGC")])]),a._v(" "),t("tr",[t("td",[a._v("-XX:+UseConcMarkSweepGC")]),a._v(" "),t("td",[a._v("新生代ParNew,老年代使用CMS")])]),a._v(" "),t("tr",[t("td",[a._v("-XX:+UseG1GC")]),a._v(" "),t("td",[a._v("使用G1回收器，作用于新老代")])])])]),a._v(" "),t("h4",{attrs:{id:"cms"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cms"}},[a._v("#")]),a._v(" CMS")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[a._v("–XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("CMSInitiatingOccupancyFraction")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("70")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("UseCMSInitiatingOccupancyOnly")]),a._v("\n")])])]),t("p",[a._v("CMS回收阈值，如果想指定，必须把Only那个参数也带上，否则JVM只管一次，后续自动调整")]),a._v(" "),t("p",[a._v("我一般都不设置这两个参数😂")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ExplicitGCInvokesConcurrent")]),a._v("\n")])])]),t("p",[a._v("如果代码中有system.gc()的话，会直接来一次FullGC")]),a._v(" "),t("p",[a._v("这个参数可以让CMS并行执行FullGC")]),a._v(" "),t("h4",{attrs:{id:"g1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#g1"}},[a._v("#")]),a._v(" G1")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("MaxGCPauseMillis")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("200")]),a._v("\n")])])]),t("p",[a._v("每次回收的软时间限制")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("InitiatingHeapOccupancyPercent")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("45")]),a._v("\n")])])]),t("p",[t("strong",[a._v("启动并发收集时的百分比")]),a._v("这个参数很重要，而且特异性很强，建议仔细研究研究")]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("UseStringDeduplication")]),a._v("\n")])])]),t("p",[a._v("G1独有的字符串去重技术，很推荐加上")])])}),[],!1,null,null,null);s.default=e.exports}}]);