(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{481:function(t,a,s){"use strict";s.r(a);var r=s(27),v=Object(r.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"悲观锁、乐观锁"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#悲观锁、乐观锁"}},[t._v("#")]),t._v(" 悲观锁、乐观锁")]),t._v(" "),s("h4",{attrs:{id:"通俗理解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通俗理解"}},[t._v("#")]),t._v(" 通俗理解")]),t._v(" "),s("ol",[s("li",[t._v("悲观锁：假设每次修改目标数据时，其它线程也要修改，修改之前，加锁，防止其他线程进入，修改之后再解锁")]),t._v(" "),s("li",[t._v("乐观锁：假设每次修改目标数据时，其他线程都不修改，修改时再判断数据是否被其他线程修改过")])]),t._v(" "),s("h4",{attrs:{id:"适用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适用场景"}},[t._v("#")]),t._v(" 适用场景")]),t._v(" "),s("ol",[s("li",[t._v("悲观锁、乐观锁没有优劣之分，都是极其成熟的思想")]),t._v(" "),s("li",[t._v("悲观锁常常用于"),s("strong",[t._v("写")]),t._v("场合较多的地方，乐观锁常常用于"),s("strong",[t._v("读")]),t._v("场合较多的地方")])]),t._v(" "),s("h3",{attrs:{id:"cas-（compare-and-sweep）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cas-（compare-and-sweep）"}},[t._v("#")]),t._v(" CAS （Compare-And-Sweep）")]),t._v(" "),s("h4",{attrs:{id:"基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本概念"}},[t._v("#")]),t._v(" 基本概念")]),t._v(" "),s("p",[t._v("CAS有3个操作数，内存值V，旧的预期值A，要修改的新值B。当且仅当预期值A和内存值V相同时，将内存值V修改为B，否则什么都不做")]),t._v(" "),s("h4",{attrs:{id:"aba问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#aba问题"}},[t._v("#")]),t._v(" ABA问题")]),t._v(" "),s("p",[t._v("例如，"),s("strong",[t._v("我")]),t._v("在修改之前，读取的值为1，而"),s("strong",[t._v("其他人")]),t._v("在"),s("strong",[t._v("我")]),t._v("写入时，已经将1改为2，又将2改为了1，对于"),s("strong",[t._v("我")]),t._v("来说，1是没有变的，而实际上已经变了。这就是ABA问题")]),t._v(" "),s("p",[t._v("想解决这个问题，就需要加一个"),s("strong",[t._v("版本")]),t._v("的概念，类似于git或svn，一样的代码，但是版本号不一样，这样就容易区分了")]),t._v(" "),s("h4",{attrs:{id:"不易长时间自旋"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不易长时间自旋"}},[t._v("#")]),t._v(" 不易长时间自旋")]),t._v(" "),s("p",[t._v("自旋这个操作虽然效率高，但是不停的比较和判断是很消耗CPU资源的，N多线程如果都按自旋方式来更新数据，那么CPU是吃不消的")]),t._v(" "),s("p",[t._v("所以如果是轻量级的线程竞争，竞争时间较短，推荐使用自旋方式")])])}),[],!1,null,null,null);a.default=v.exports}}]);